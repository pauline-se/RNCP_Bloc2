########################################
# I- Préparation données US_aves.parquet
########################################
 
 
Aperçu du fichier
[Row(id=22176446, eventDate='2019-03-23T12:41:00-04:00', decimalLatitude=29.1774185733, decimalLongitude=-81.0133747, countryCode='US', stateProvince='Florida', taxonID=145242, scientificName='Setophaga palmarum', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Passeriformes', family='Parulidae', genus='Setophaga'), Row(id=22176447, eventDate='2019-03-23T12:41:00-04:00', decimalLatitude=29.1774452352, decimalLongitude=-81.0133919357, countryCode='US', stateProvince='Florida', taxonID=145245, scientificName='Setophaga coronata', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Passeriformes', family='Parulidae', genus='Setophaga'), Row(id=22176451, eventDate='2019-03-23T12:51:00-04:00', decimalLatitude=29.1774317805, decimalLongitude=-81.0133841983, countryCode='US', stateProvince='Florida', taxonID=145242, scientificName='Setophaga palmarum', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Passeriformes', family='Parulidae', genus='Setophaga'), Row(id=22176453, eventDate='2019-03-23T13:06:00-04:00', decimalLatitude=29.1773856208, decimalLongitude=-81.0135692707, countryCode='US', stateProvince='Florida', taxonID=12942, scientificName='Sialia sialis', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Passeriformes', family='Turdidae', genus='Sialia'), Row(id=22176454, eventDate='2019-03-23T13:08:00-04:00', decimalLatitude=29.1773423589, decimalLongitude=-81.0134593001, countryCode='US', stateProvince='Florida', taxonID=12942, scientificName='Sialia sialis', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Passeriformes', family='Turdidae', genus='Sialia'), Row(id=22176456, eventDate='2019-03-23T13:19:00-04:00', decimalLatitude=29.1773324231, decimalLongitude=-81.013520991, countryCode='US', stateProvince='Florida', taxonID=145242, scientificName='Setophaga palmarum', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Passeriformes', family='Parulidae', genus='Setophaga'), Row(id=22176458, eventDate='2019-03-23T15:36:00-04:00', decimalLatitude=29.1888967951, decimalLongitude=-81.0103499312, countryCode='US', stateProvince='Florida', taxonID=5212, scientificName='Buteo jamaicensis', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Accipitriformes', family='Accipitridae', genus='Buteo'), Row(id=22176459, eventDate='2019-03-23T13:19:00-04:00', decimalLatitude=29.1773324231, decimalLongitude=-81.013520991, countryCode='US', stateProvince='Florida', taxonID=13858, scientificName='Passer domesticus', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Passeriformes', family='Passeridae', genus='Passer'), Row(id=22176567, eventDate='2013-08-27', decimalLatitude=29.7198062493, decimalLongitude=-95.400568537, countryCode='US', stateProvince='Texas', taxonID=73148, scientificName='Parkesia motacilla', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Passeriformes', family='Parulidae', genus='Parkesia'), Row(id=22176624, eventDate='2019-04-07T17:23:00-06:00', decimalLatitude=40.0636560334, decimalLongitude=-105.2937977976, countryCode='US', stateProvince='Colorado', taxonID=6930, scientificName='Anas platyrhynchos', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Anseriformes', family='Anatidae', genus='Anas'), Row(id=22176625, eventDate='2019-04-07T17:11:00-06:00', decimalLatitude=40.0612642823, decimalLongitude=-105.2908426605, countryCode='US', stateProvince='Colorado', taxonID=17009, scientificName='Sayornis saya', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Passeriformes', family='Tyrannidae', genus='Sayornis'), Row(id=22176626, eventDate='2019-04-07T17:13:00-06:00', decimalLatitude=40.0594467529, decimalLongitude=-105.2950607635, countryCode='US', stateProvince='Colorado', taxonID=4756, scientificName='Cathartes aura', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Cathartiformes', family='Cathartidae', genus='Cathartes'), Row(id=22176628, eventDate='2019-04-07T17:10:00-06:00', decimalLatitude=40.0612439601, decimalLongitude=-105.2901131983, countryCode='US', stateProvince='Colorado', taxonID=199840, scientificName='Haemorhous mexicanus', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Passeriformes', family='Fringillidae', genus='Haemorhous'), Row(id=22176630, eventDate='2019-04-07T17:09:00-06:00', decimalLatitude=40.06106977, decimalLongitude=-105.2893918813, countryCode='US', stateProvince='Colorado', taxonID=12727, scientificName='Turdus migratorius', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Passeriformes', family='Turdidae', genus='Turdus'), Row(id=22176633, eventDate='2019-04-07T17:08:00-06:00', decimalLatitude=40.0611679993, decimalLongitude=-105.2888098734, countryCode='US', stateProvince='Colorado', taxonID=18236, scientificName='Colaptes auratus', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Piciformes', family='Picidae', genus='Colaptes'), Row(id=22176636, eventDate='2019-04-07T17:27:00-06:00', decimalLatitude=40.0626228929, decimalLongitude=-105.2940977481, countryCode='US', stateProvince='Colorado', taxonID=5112, scientificName='Accipiter cooperii', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Accipitriformes', family='Accipitridae', genus='Accipiter'), Row(id=22176637, eventDate='2019-04-07T17:52:00-06:00', decimalLatitude=40.0679598413, decimalLongitude=-105.2913554562, countryCode='US', stateProvince='Colorado', taxonID=9535, scientificName='Sturnella neglecta', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Passeriformes', family='Icteridae', genus='Sturnella'), Row(id=22176642, eventDate='2019-04-07T16:05:00-04:00', decimalLatitude=42.4091415462, decimalLongitude=-71.5326873274, countryCode='US', stateProvince='Massachusetts', taxonID=7044, scientificName='Aythya collaris', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Anseriformes', family='Anatidae', genus='Aythya'), Row(id=22176648, eventDate='2012-10-30', decimalLatitude=29.7203951437, decimalLongitude=-95.3958086346, countryCode='US', stateProvince='Texas', taxonID=6363, scientificName='Selasphorus rufus', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Caprimulgiformes', family='Trochilidae', genus='Selasphorus'), Row(id=22176823, eventDate='2019-04-07T09:53:13-07:00', decimalLatitude=38.6174999792, decimalLongitude=-121.3116882288, countryCode='US', stateProvince='California', taxonID=506118, scientificName='Aphelocoma californica', taxonRank='species', kingdom='Animalia', phylum='Chordata', class='Aves', order='Passeriformes', family='Corvidae', genus='Aphelocoma')]
 
Description du fichier
+-------+-------------------+--------------------+-----------------+------------------+-----------+-------------+------------------+-----------------+---------+--------+--------+-------+---------------+------------+---------+
|summary|                 id|           eventDate|  decimalLatitude|  decimalLongitude|countryCode|stateProvince|           taxonID|   scientificName|taxonRank| kingdom|  phylum|  class|          order|      family|    genus|
+-------+-------------------+--------------------+-----------------+------------------+-----------+-------------+------------------+-----------------+---------+--------+--------+-------+---------------+------------+---------+
|  count|            6426186|             6426186|          6426186|           6426186|    6426186|      6426186|           6426186|          6426186|  6426186| 6426186| 6426186|6426186|        6426186|     6426179|  6423939|
|   mean| 8.20693040490935E7|                null|36.73116724181847| -99.0787422531808|       null|         null| 94977.98562273174|             null|     null|    null|    null|   null|           null|        null|     null|
| stddev|5.139690320010071E7|                null|  5.8347984341349|18.822213424033873|       null|         null|237577.75848248843|             null|     null|    null|    null|   null|           null|        null|     null|
|    min|                 73|1895-04-05T11:00:...|    18.8038825015|   -178.7357833333|         US|      Alabama|                 7|         Acanthis|  complex|Animalia|Chordata|   Aves|Accipitriformes|Accipitridae| Acanthis|
|    max|          177414571|2023-08-08T17:52:...|    71.3971348521|    179.3468572309|         US|      Wyoming|           1472018|Zosterops simplex|  variety|Animalia|Chordata|   Aves|  Trogoniformes|Zosteropidae|Zosterops|
+-------+-------------------+--------------------+-----------------+------------------+-----------+-------------+------------------+-----------------+---------+--------+--------+-------+---------------+------------+---------+

 
Exploration colonne id :
+---------+
|       id|
+---------+
|163746913|
|163746914|
|163746915|
|  5791185|
|163746921|
|163746922|
|163746924|
|163746926|
|163746927|
|163746928|
|163746930|
|163746931|
|163746933|
|163746938|
|163746939|
|163746940|
|  5791220|
|163746944|
|163746945|
|163746951|
+---------+
only showing top 20 rows

 
Exploration colonne StateProvince :
+-------------+
|StateProvince|
+-------------+
|        Texas|
|        Texas|
|   California|
|   California|
|     Missouri|
|        Texas|
|        Texas|
|        Texas|
|        Texas|
|        Texas|
|        Texas|
|        Texas|
|        Texas|
|        Texas|
|        Texas|
|        Texas|
|Massachusetts|
|        Texas|
|        Texas|
|        Texas|
+-------------+
only showing top 20 rows

 
Exploration colonne eventDate :
+--------------------+
|           eventDate|
+--------------------+
|2023-04-29T20:35:...|
|2023-04-29T20:35:...|
|2023-05-24T17:38:...|
|2017-04-17T09:14:...|
|2023-05-25T09:12:...|
|2023-04-29T20:35:...|
|2023-04-29T20:35:...|
|2023-04-29T20:35:...|
|2023-04-29T20:35:...|
|2023-04-29T20:35:...|
|2023-04-29T20:35:...|
|2023-04-29T20:35:...|
|2023-04-29T20:35:...|
|2023-04-29T20:35:...|
|2023-04-29T20:35:...|
|2023-04-29T20:35:...|
|2017-04-17T12:49:...|
|2023-04-29T20:35:...|
|2023-04-29T20:35:...|
|2023-04-29T20:35:...|
+--------------------+
only showing top 20 rows

 
Nombre de lignes dans le fichier US_aves (initial) : 6426186
 
Nombre de id observations uniques dans le dataframe US_aves : 6426186
 
Unicité des id observations :  Vrai
 
Nombre de lignes après suppression des lignes avec id taxons non renseignés : 6426186
 
Nombre de lignes supprimées à cause de id taxons non renseignés : 0
 
Nombre de lignes de la colonne yearEvent nulles : 0
Nombre de lignes de la colonne monthEvent nulles : 0
Nombre de lignes de la colonne eventDate nulles : 0
Nombre de lignes de la colonne yearMonthEvent nulles : 0
Les lignes avec une date manquante ou mal renseignée ont été supprimées. Total des lignes supprimées : 0
 
Nombre de lignes supprimées pre 2017 et post 2022 : 1496213
 
Nouveau décompte de lignes : 4929973
 
Nombre de lignes de la colonne decimalLatitude nulles : 0
 
Nombre de lignes de la colonne decimalLongitude nulles : 0
 
Les lignes avec latitude ou longitude manquante ou mal renseignée ont été supprimées. Total des lignes supprimées : 0
 
Nombre de lignes final US_aves :  4929973
 
 
 
################################################
# II- Préparation fichier Noms_especes.parquet
################################################
 
 
Aperçu du fichier Noms_especes :
[Row(taxonID=45997, Name='Écureuil de Deppe'), Row(taxonID=45996, Name='Écureuil du Brésil'), Row(taxonID=45995, Name='Écureuil du Venezuela'), Row(taxonID=46002, Name='Écureuil de Bolivie'), Row(taxonID=45999, Name="Écureuil roux du nord de l'Amazonie"), Row(taxonID=46006, Name='Écureuil du Junin'), Row(taxonID=46011, Name="Écureuil du sud de l'Amazonie"), Row(taxonID=46007, Name='Écureuil de Colombie'), Row(taxonID=46012, Name='Écureuil du Sanborn'), Row(taxonID=46024, Name='Écureuil du Nayarit'), Row(taxonID=46008, Name='Écureuil de Peter'), Row(taxonID=46000, Name='Écureuil du Japon'), Row(taxonID=46004, Name='Écureuil du Guayaquil'), Row(taxonID=46013, Name='Écureuil de Richmond'), Row(taxonID=258162, Name='Petit hibou à bandes étroites'), Row(taxonID=24495, Name='Crapaud sonneur à ventre de feu'), Row(taxonID=62941, Name='Patate douce'), Row(taxonID=193722, Name='Maté'), Row(taxonID=4323, Name='Pélicans'), Row(taxonID=128138, Name='Limodores')]
 
Description du fichier Noms_especes :
+-------+------------------+--------------------+
|summary|           taxonID|                Name|
+-------+------------------+--------------------+
|  count|             51705|               51705|
|   mean|293058.02382748283|                null|
| stddev|  349858.055830422|                null|
|    min|                 1|"""Potentille ram...|
|    max|           1460613|​Étoile à aissell...|
+-------+------------------+--------------------+

 
Taxons ID en double ou plus :
+-------+-----+
|taxonID|count|
+-------+-----+
|   4519|    2|
|  41946|    2|
|  82730|    2|
| 119432|    2|
| 326052|    7|
| 480251|    3|
| 334985|    5|
|   4935|    2|
| 464147|    2|
| 337873|    2|
|  77422|    2|
| 156296|    2|
| 460123|    2|
| 905463|    2|
| 434587|    2|
|  97004|    4|
|  41751|    4|
|1159834|    2|
| 146464|    2|
|1392699|    3|
+-------+-----+
only showing top 20 rows

 
Nombre de doublons dans les ID taxons : 6045
 
lignes restantes en doublons :
+-------+-----+
|taxonID|count|
+-------+-----+
+-------+-----+

 
fichier sans doublon :
+-------+--------------------+
|taxonID|                Name|
+-------+--------------------+
|      1|             Animaux|
|      2|             Chordés|
|      3|             Oiseaux|
|      5|            Courlans|
|      6|            Courlans|
|      7|        Courlan brun|
|     14|       Cariama huppé|
|     16|Cariama de Burmei...|
|     19|      Caurale soleil|
|     23|               Grues|
|     25|     Grue à cou noir|
|     26|          Grue moine|
|     34|        grue blanche|
|     39|       Grue du Japon|
|     41|        Grue cendrée|
|     46|          Piquebœufs|
|     50|      Grue couronnée|
|     53|         Grue royale|
|     56|           Glaucopes|
|     58|       Grébifoulques|
+-------+--------------------+
only showing top 20 rows

 
nombre de lignes dans french names : 43474
 
########################################
# III- Préparation Noms_Etats.parquet   
########################################
 
 
Aperçu du fichier Noms_Etats :
[Row(StateName='North Carolina', StateCode='NC'), Row(StateName='North Dakota', StateCode='ND'), Row(StateName='Ohio', StateCode='OH'), Row(StateName='Oklahoma', StateCode='OK'), Row(StateName='Oregon', StateCode='OR'), Row(StateName='Pennsylvania', StateCode='PA'), Row(StateName='Puerto Rico', StateCode='PR'), Row(StateName='Rhode Island', StateCode='RI'), Row(StateName='South Carolina', StateCode='SC'), Row(StateName='South Dakota', StateCode='SD'), Row(StateName='Tennessee', StateCode='TN'), Row(StateName='Texas', StateCode='TX'), Row(StateName='Utah', StateCode='UT'), Row(StateName='Vermont', StateCode='VT'), Row(StateName='Virgin Islands', StateCode='VI'), Row(StateName='Virginia', StateCode='VA'), Row(StateName='Washington', StateCode='WA'), Row(StateName='West Virginia', StateCode='WV'), Row(StateName='Wisconsin', StateCode='WI'), Row(StateName='Wyoming', StateCode='WY')]
 
Description du fichier Noms_Etats :
+-------+---------+---------+
|summary|StateName|StateCode|
+-------+---------+---------+
|  count|       55|       55|
|   mean|     null|     null|
| stddev|     null|     null|
|    min|  Alabama|       AK|
|    max|  Wyoming|       WY|
+-------+---------+---------+

 
Pas de doublons dans le fichier Noms_Etats
 
########################################################################
# IV- Jointure des 3 dataframes et ecriture du nouveau fichier parquet
########################################################################
 
 
Nombre lignes dans dataframe df_obs avant jointure : 4929973
 
Nombre lignes Name nulles : 65109
Nombre lignes Name non nulles : 4864864
 
Colonne Name : 
+--------------------+
|                Name|
+--------------------+
|Pigeon à queue ba...|
|     Bruant chanteur|
|Carouge à épaulettes|
| hirondelle bicolore|
|Pigeon à queue ba...|
|paruline noir et ...|
|      pic flamboyant|
|    Bernache cravant|
|  Moineau domestique|
|      Canard colvert|
|           Geai bleu|
|  Bernache du Canada|
|         Grand Héron|
|Quiscale à longue...|
|     grimpereau brun|
|          pic mineur|
|         Grand Héron|
|  urubu à tête rouge|
|      Canard colvert|
|   Geai de Woodhouse|
+--------------------+
only showing top 20 rows

 
Colonne StateCode : 
+---------+
|StateCode|
+---------+
|       CA|
|       MA|
|       NY|
|       MA|
|       CA|
|       TX|
|       NY|
|       NY|
|       NY|
|       TX|
|       FL|
|       OR|
|       TX|
|       TX|
|       MA|
|       MA|
|       TX|
|       CA|
|       CA|
|       TX|
+---------+
only showing top 20 rows

 
Nombre lignes dans dataframe df_obs après les 2 jointures : 4929973
 
Jointure ne duplique pas les lignes :  Vrai
 
